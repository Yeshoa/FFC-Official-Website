---
import Layout from '@layouts/App.astro'
import RelatedNews from '@components/articles/RelatedNews.astro';
import Legend from '@components/ranking/Legend.astro';
import Table from '@components/ranking/Table.astro';

import { getMembers, getTournaments, getMatches, getArticles } from '@lib/collections';
import{ getArticlesByTags } from 'src/utils/articleUtils';
import { CURRENT_TOURNAMENT_ID } from 'src/utils/tournamentUtils';
import Title from '@components/Title.astro';
import { LOCALE } from '@config/constants';

const members = await getMembers();
const tournaments = await getTournaments();
const matches = await getMatches();
const articles = await getArticles();

const filterTags = [
  "ranking",
];

const filteredArticles = getArticlesByTags(articles, filterTags);

// Opcional: especificar el torneo actual
const currentTournamentId = CURRENT_TOURNAMENT_ID;
const date = new Date().toLocaleString(LOCALE, { month: 'long', day: 'numeric', year: 'numeric' });
---
<Layout title="FFC - Ranking">
  <main class="w-full p-6 items-center">
    <Title slideIn={true}>
      Ranking
      <span slot="subtitle">
       Last updated {date}
      </span>
    </Title>
    <Legend />
    <Table members={members} currentTournamentId={currentTournamentId} />
    <RelatedNews articles={filteredArticles} max={4} />
  </main>
</Layout>
