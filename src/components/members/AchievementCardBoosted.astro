---
import { Image } from 'astro:assets';
const { achievement } = Astro.props;
import StarIcon from '@images/icons/star-solid.svg'; 
import SkullIcon from '@images/icons/skull-crossbones-solid.svg';

// Rarity mapping REFINADO con animaciones sutiles y poderosas
const rarityMap = {
  // --- Tiers Negativos ---
  'Ravaged': { // NUEVA ANIMACIÓN
    label: 'Ravaged',
    color: 'bg-gradient-to-b from-black  via-red-950 via-65% to-red-900',
    border: 'border-black',
    text: 'text-red-600',
    name: 'text-black font-bold text-shadow-sm text-shadow-black',
    shadow: 'shadow-red-950/30',
    glow: 'group-hover:shadow-orange-800/60',
    sparkle: 'bg-orange-600',
    icons: { type: 'skull', count: 6, color: 'fill-black' },
    animationClass: 'ravaged-inferno', // Efecto de fuego interno
  },
  'Doomed': { // AHORA TIENE LA ANIMACIÓN ANTERIOR DE RAVAGED
    label: 'Doomed',
    color: 'bg-gradient-to-br from-black via-gray-900 to-red-950',
    border: 'border-orange-700',
    text: 'text-orange-500',
    name: 'text-orange-700 font-bold text-shadow-sm text-shadow-black',
    shadow: 'shadow-gray-900/30',
    glow: 'group-hover:shadow-red-950/40',
    sparkle: 'bg-red-950',
    icons: { type: 'skull', count: 5, color: 'fill-orange-700' },
    animationClass: 'doomed-fire-cracks', // Llamas y grietas
  },
  'Cursed': { // SE MANTIENE
    label: 'Cursed',
    color: 'bg-gradient-to-br from-gray-900 via-red-950 to-black',
    border: 'border-red-900',
    text: 'text-red-700',
    name: 'text-red-700 font-bold text-shadow-sm text-shadow-black',
    shadow: 'shadow-red-900/50',
    glow: 'group-hover:shadow-red-800/60',
    sparkle: 'bg-red-700',
    icons: { type: 'skull', count: 4, color: 'fill-red-700' },
    animationClass: 'cursed-orbs-runes', // Orbes y runas sutiles
  },
  'Broken': { // AHORA TIENE EL HUMO (SIN CADENAS)
    label: 'Broken',
    color: 'bg-gradient-to-br from-gray-800 via-gray-700 to-gray-900',
    border: 'border-gray-600',
    text: 'text-gray-300',
    name: 'text-gray-500 font-bold text-shadow-sm text-shadow-black',
    shadow: 'shadow-gray-700/50',
    glow: 'group-hover:shadow-gray-600/60',
    sparkle: 'bg-gray-500',
    icons: { type: 'skull', count: 3, color: 'fill-gray-500' },
    animationClass: 'broken-dust-scratches', // Solo el humo
  },
  // --- Tiers Comunes/Bajos ---
  'Worn': { // SE MANTIENE
    label: 'Worn',
    color: 'bg-gradient-to-br from-stone-800 via-stone-700 to-stone-900',
    border: 'border-stone-600',
    text: 'text-stone-300',
    name: 'text-stone-400 font-bold text-shadow-sm text-shadow-black',
    shadow: 'shadow-stone-700/50',
    glow: 'group-hover:shadow-stone-600/60',
    sparkle: 'bg-stone-500',
    icons: { type: 'skull', count: 2, color: 'fill-stone-400' },
//     animationClass: 'worn-smoke', // Polvo y rayones
  },
  'Mundane': { // SE MANTIENE
    label: 'Mundane',
    color: 'bg-gradient-to-br from-lime-900 via-lime-900 to-lime-950',
    border: 'border-lime-800',
    text: 'text-lime-600',
    name: 'text-lime-600 font-bold text-shadow-sm text-shadow-black',
    shadow: 'shadow-lime-700/50',
    glow: 'group-hover:shadow-lime-600/60',
    sparkle: 'bg-lime-500',
    icons: { type: 'skull', count: 1, color: 'fill-lime-600' },
    animationClass: 'mundane-glow-pulse', // Brillo y pulso
  },
  // --- Tiers Positivos ---
  'Common': { // SE MANTIENE
    label: 'Common',
    color: 'bg-slate-500',
    border: 'border-gray-400',
    text: 'text-slate-200',
    name: 'text-slate-200 font-bold text-shadow-sm text-shadow-black',
    shadow: 'shadow-slate-400/60',
    glow: 'group-hover:shadow-slate-400/80',
    sparkle: 'bg-slate-400/20',
    icons: { type: 'star', count: 0, color: 'fill-yellow-400' },
  },
  'Uncommon': { // NUEVA ANIMACIÓN
    label: 'Uncommon',
    color: 'bg-gradient-to-br from-emerald-500 via-emerald-600 to-emerald-700',
    border: 'border-emerald-400',
    text: 'text-emerald-100',
    name: 'text-emerald-100 font-bold text-shadow-sm text-shadow-black',
    shadow: 'shadow-emerald-400/60',
    glow: 'group-hover:shadow-emerald-400/80',
    sparkle: 'bg-emerald-400/20',
    icons: { type: 'star', count: 1, color: 'fill-slate-200' },
  },
  'Rare': { // NUEVA ANIMACIÓN
    label: 'Rare',
    color: 'bg-gradient-to-br from-blue-500 via-sky-400 to-blue-600',
    border: 'border-sky-400',
    text: 'text-sky-100',
    name: 'text-sky-100 font-bold text-shadow-sm text-shadow-black',
    shadow: 'shadow-sky-400/60',
    glow: 'group-hover:shadow-sky-400/80',
    sparkle: 'bg-sky-400/20',
    icons: { type: 'star', count: 2, color: 'fill-yellow-400' },
    animationClass: 'uncommon-breathing-glow bg-gradient-to-tl from-blue-950 via-sky-100 to-blue-900', // Brillo que respira
  },
  'Ultra Rare': { // SE MANTIENE
    label: 'Ultra Rare',
    color: 'bg-gradient-to-br from-sky-500 via-violet-600 to-fuchsia-600',
    border: 'border-violet-400',
    text: 'text-cyan-300',
    name: 'text-violet-100 font-bold text-shadow-sm text-shadow-black',
    shadow: 'shadow-violet-400/60',
    glow: 'group-hover:shadow-violet-400/80',
    sparkle: 'bg-violet-400',
    icons: { type: 'star', count: 3, color: 'fill-sky-300' },
    animationClass: 'ultra-rare-plasma-hologram', // Plasma y holograma,
  },
  'Epic': {
    label: 'Epic',
    color: 'bg-gradient-to-br from-red-950 via-red-700 from-20% via-65% to-amber-600',
    border: 'border-amber-300',
    text: 'text-amber-200',
    name: 'text-amber-200 font-black text-shadow-lg text-shadow-amber-400',
    shadow: 'shadow-red-500/60',
    glow: 'group-hover:shadow-red-600/80',
    sparkle: 'bg-amber-300',
    icons: { type: 'star', count: 4, color: 'fill-yellow-300' },
    animationClass: 'epic-power-flow',
  },
  'Legendary': {
    label: 'Legendary',
    color: 'bg-gradient-to-bl from-yellow-600 via-amber-900 to-yellow-700',
    border: 'border-yellow-200',
    text: 'text-white',
    name: 'text-yellow-100 text-shadow-lg text-shadow-yellow-300',
    shadow: 'shadow-yellow-400/60',
    glow: 'group-hover:shadow-yellow-300/80',
    sparkle: 'bg-yellow-200',
    icons: { type: 'star', count: 5, color: 'fill-yellow-200' },
    animationClass: 'legendary-golden-pulse rare-shine',
  },
  'Ultra': {
    label: 'Ultra',
    color: 'bg-gradient-to-t from-blue-900 via-purple-950 to-black',
    border: 'border-cyan-300',
    text: 'text-cyan-200',
    name: 'text-white',
    shadow: 'shadow-purple-600/50',
    glow: 'group-hover:shadow-cyan-500/70',
    sparkle: 'bg-white',
    icons: { type: 'star', count: 6, color: 'fill-cyan-300' },
    animationClass: 'ultra-cosmic-field',
  }
};

const rarity = rarityMap[achievement.rarity] || rarityMap['Common'];
---

<div class="achievement-card group" tabindex="0" role="button" aria-label={`Ver detalles de ${achievement.name}`}>
  <div class="flip-card-inner">
    
    <div class={`flip-card-front relative flex flex-col items-center gap-1 p-3 ${rarity.color || 'bg-gradient-to-br from-blue-500 via-sky-400 to-blue-600'} ${rarity.border} ${rarity.animationBorder} border-2 ${rarity.shadow} ${rarity.glow} transition-all duration-500 w-[120px] h-[160px] overflow-hidden`}>
      
       <!-- ANIMACIÓN ESPECÍFICA POR RAREZA -->
      <div class={`absolute inset-0 overflow-hidden pointer-events-none ${rarity.animationClass}`}>
        <!-- Ravaged: Infierno interno -->
        {achievement.rarity === 'Ravaged' && (
          <>
            <div class="ravaged-flame ravaged-flame-1"></div>
            <div class="ravaged-flame ravaged-flame-2"></div>
            <div class="ravaged-flame ravaged-flame-3"></div>
            <div class="ravaged-flame ravaged-flame-4"></div>
            <div class="ravaged-ember ravaged-ember-1"></div>
            <div class="ravaged-ember ravaged-ember-2"></div>
            <div class="ravaged-ember ravaged-ember-3"></div>
            <div class="ravaged-ember ravaged-ember-4"></div>
            <div class="ravaged-heat-wave"></div>
            <div class="ravaged-core-fire"></div>
          </>
        )}
        <!-- Doomed: Fuego y grietas -->
        {achievement.rarity === 'Doomed' && (
          <>
            <div class="doomed-crack doomed-crack-1"></div>
            <div class="doomed-crack doomed-crack-2"></div>
            <div class="doomed-crack doomed-crack-3"></div>
            <div class="doomed-fire-burst doomed-fire-burst-1"></div>
            <div class="doomed-fire-burst doomed-fire-burst-2"></div>
            <div class="doomed-fire-burst doomed-fire-burst-3"></div>
            <div class="doomed-smoke doomed-smoke-1"></div>
            <div class="doomed-smoke doomed-smoke-2"></div>
            <div class="doomed-destruction-pulse"></div>
          </>
        )}
        <!-- Cursed: Orbes y runas malditas -->
        {achievement.rarity === 'Cursed' && (
          <>
            <div class="cursed-orb cursed-orb-1"></div>
            <div class="cursed-orb cursed-orb-2"></div>
            <div class="cursed-orb cursed-orb-3"></div>
            <div class="cursed-shadow-pulse"></div>
            <div class="cursed-particle cursed-particle-1"></div>
            <div class="cursed-particle cursed-particle-2"></div>
            <div class="cursed-particle cursed-particle-3"></div>
          </>
        )}
        <!-- Epic: Ondas de energía -->
        {achievement.rarity === 'Epic' && (
          <>
            <div class="epic-wave epic-wave-1"></div>
            <div class="epic-wave epic-wave-2"></div>
            <div class="epic-wave epic-wave-3"></div>
          </>
        )}
        
        <!-- Legendary: Corona dorada divina -->
        {achievement.rarity === 'Legendary' && (
          <>
            {/* <div class="legendary-ray legendary-ray-1"></div>
            <div class="legendary-ray legendary-ray-2"></div>
            <div class="legendary-ray legendary-ray-3"></div>
            <div class="legendary-ray legendary-ray-4"></div>
            <div class="legendary-ray legendary-ray-5"></div>
            <div class="legendary-ray legendary-ray-6"></div> */}
            <div class="legendary-sparkle legendary-sparkle-1"></div>
            <div class="legendary-sparkle legendary-sparkle-2"></div>
            <div class="legendary-sparkle legendary-sparkle-3"></div>
            <div class="legendary-sparkle legendary-sparkle-4"></div>
            <div class="legendary-sparkle legendary-sparkle-5"></div>
          </>
        )}
        
        <!-- Ultra: Campo cósmico -->
        {achievement.rarity === 'Ultra' && (
          <>
            <div class="ultra-star ultra-star-1"></div>
            <div class="ultra-star ultra-star-2"></div>
            <div class="ultra-star ultra-star-3"></div>
            <div class="ultra-star ultra-star-4"></div>
            <div class="ultra-star ultra-star-5"></div>
            <div class="ultra-star ultra-star-6"></div>
            <div class="ultra-nebula"></div>
            <div class="legendary-ray legendary-ray-1"></div>
            <div class="legendary-ray legendary-ray-2"></div>
            <div class="legendary-ray legendary-ray-3"></div>
            <div class="legendary-ray legendary-ray-4"></div>
            <div class="legendary-ray legendary-ray-5"></div>
            <div class="legendary-ray legendary-ray-6"></div>
          </>
        )}
      </div>
      
      <div class="absolute top-0 left-0 right-0 h-8 bg-gradient-to-b from-white/10 to-transparent pointer-events-none z-10"></div>
      
      <div class="icon-container relative z-20 group-hover:animate-bounce mt-2">
        <Image src={achievement.icon} alt={achievement.name} width={80} height={80} class="w-12 h-12 drop-shadow-2xl" loading="eager" quality="70" format="webp" />
      </div>
      
      <div class="name-container relative z-20 flex-grow flex items-center justify-center text-center px-1 h-8">
        <span class={`ext-center ${rarity.name} font-bold leading-tight transition-all duration-300 group-hover:text-white text-shadow-sm ${achievement.name.length > 15 ? 'text-xs' : 'text-sm'}`}>
          {achievement.name}
        </span>
      </div>

      {rarity.icons.count > 0 && (
        <div class="relative z-20 flex flex-row justify-center items-center gap-0.5 h-4">
          {Array.from({ length: rarity.icons.count }).map(() => (
            rarity.icons.type === 'star' ?
              <StarIcon class={`w-3 h-3 ${rarity.icons.color}`} /> :
              <SkullIcon class={`w-3 h-3 ${rarity.icons.color}`} />
          ))}
        </div>
      )}
      
      <div class={`rarity-badge absolute rounded-xl -top-1 -right-1 px-2 py-0.5 text-xs font-semibold uppercase ${rarity.text} bg-black/60 border ${rarity.border} transform transition-all duration-300 group-hover:scale-110 group-hover:rotate-12 z-30`}>
        {rarity.label}
      </div>
    </div>

    <div class={`flip-card-back absolute w-full h-full bg-gradient-to-br ${rarity.color} ${rarity.border} ${rarity.animationBorder} border-2 p-3 flex flex-col items-center`}>
      <div class={`inline-block px-2 py-0.5 text-center text-xs font-semibold uppercase ${rarity.text} bg-black/50 rounded-xl border ${rarity.border}`}>
        {rarity.label}
      </div>
      <div class="flex-1 w-full flex items-center justify-center">
        <p class={`${rarity.text} text-xs leading-relaxed text-center`}>{achievement.description}</p>
      </div>
    </div>

  </div>
</div>

<style>
/* --- ESTRUCTURA DE LA CARTA (CON GIRO) --- */
.achievement-card {
  background-color: transparent;
  width: 120px;
  height: 160px;
  perspective: 1000px;
  cursor: pointer;
}

.flip-card-inner {
  position: relative;
  width: 100%;
  height: 100%;
  transition: transform 0.7s;
  transform-style: preserve-3d;
  box-shadow: 0 8px 32px 0 rgba(0,0,0,0.3);
  /* Addded will-change for performance optimization. */
  will-change: transform;
}

.achievement-card.is-flipped .flip-card-inner {
  transform: rotateY(180deg);
}

.flip-card-front, .flip-card-back {
  position: absolute;
  width: 100%;
  height: 100%;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
  /* Addded transform for proper layering.
  Addded will-change for performance optimization. */
  transform: translateZ(0);
  will-change: transform;
}

.flip-card-back {
  transform: rotateY(180deg);
}

/* =================== ANIMACIONES ÚNICAS POR RAREZA =================== */

/* =================== ANIMACIONES RAVAGED =================== */
.ravaged-inferno {
  border-radius: 0.75rem;
}

.ravaged-flame {
  position: absolute;
  width: 6px;
  height: 12px;
  background: linear-gradient(to top, #dc2626, #ea580c, #f59e0b);
  border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
  animation: ravaged-flame-dance 2s ease-in-out infinite;
  box-shadow: 0 0 8px rgba(234, 88, 12, 0.6);
}

.ravaged-flame-1 {
  bottom: 10%;
  left: 20%;
  animation-delay: 0s;
}

.ravaged-flame-2 {
  bottom: 15%;
  right: 25%;
  animation-delay: 0.4s;
}

.ravaged-flame-3 {
  bottom: 20%;
  left: 60%;
  animation-delay: 0.8s;
}

.ravaged-flame-4 {
  bottom: 12%;
  left: 45%;
  animation-delay: 1.2s;
}

.ravaged-ember {
  position: absolute;
  width: 3px;
  height: 3px;
  background: radial-gradient(circle, #f59e0b, #dc2626);
  border-radius: 50%;
  animation: ravaged-ember-rise 4s linear infinite;
}

.ravaged-ember-1 {
  bottom: 5%;
  left: 30%;
  animation-delay: 0s;
}

.ravaged-ember-2 {
  bottom: 8%;
  right: 35%;
  animation-delay: 1s;
}

.ravaged-ember-3 {
  bottom: 12%;
  left: 70%;
  animation-delay: 2s;
}

.ravaged-ember-4 {
  bottom: 6%;
  left: 50%;
  animation-delay: 3s;
}

.ravaged-heat-wave {
  position: absolute;
  inset: 8px;
  background: radial-gradient(ellipse at bottom, rgba(234, 88, 12, 0.15) 0%, transparent 50%);
  border-radius: 0.75rem;
  animation: ravaged-heat-pulse 3s ease-in-out infinite;
}

.ravaged-core-fire {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 80%;
  height: 30%;
  background: linear-gradient(to top, rgba(220, 38, 38, 0.3), rgba(234, 88, 12, 0.2), transparent);
  border-radius: 50% 50% 0 0;
  animation: ravaged-core-flicker 2.5s ease-in-out infinite;
}

@keyframes ravaged-flame-dance {
  0%, 100% {
    transform: translateY(0) scale(1) rotate(-2deg);
    opacity: 0.8;
  }
  25% {
    transform: translateY(-8px) scale(1.1) rotate(2deg);
    opacity: 1;
  }
  50% {
    transform: translateY(-12px) scale(0.9) rotate(-1deg);
    opacity: 0.9;
  }
  75% {
    transform: translateY(-6px) scale(1.05) rotate(1deg);
    opacity: 1;
  }
}

@keyframes ravaged-ember-rise {
  0% {
    transform: translateY(0) scale(1);
    opacity: 1;
  }
  50% {
    transform: translateY(-40px) scale(0.8);
    opacity: 0.6;
  }
  100% {
    transform: translateY(-80px) scale(0.3);
    opacity: 0;
  }
}

@keyframes ravaged-heat-pulse {
  0%, 100% {
    background: radial-gradient(ellipse at bottom, rgba(234, 88, 12, 0.1) 0%, transparent 50%);
  }
  50% {
    background: radial-gradient(ellipse at bottom, rgba(234, 88, 12, 0.2) 0%, transparent 60%);
  }
}

@keyframes ravaged-core-flicker {
  0%, 100% {
    background: linear-gradient(to top, rgba(220, 38, 38, 0.2), rgba(234, 88, 12, 0.15), transparent);
  }
  50% {
    background: linear-gradient(to top, rgba(220, 38, 38, 0.4), rgba(234, 88, 12, 0.3), transparent);
  }
}

/* =================== ANIMACIONES DOOMED =================== */
.doomed-fire-cracks {
  border-radius: 0.75rem;
}

.doomed-crack {
  position: absolute;
  width: 2px;
  background: linear-gradient(to bottom, transparent, #dc2626, #7f1d1d);
  animation: doomed-crack-spread 4s ease-in-out infinite;
  border-radius: 1px;
}

.doomed-crack-1 {
  top: 20%;
  left: 30%;
  height: 40%;
  animation-delay: 0s;
}

.doomed-crack-2 {
  top: 10%;
  right: 25%;
  height: 50%;
  animation-delay: 1.3s;
}

.doomed-crack-3 {
  top: 40%;
  left: 60%;
  height: 35%;
  animation-delay: 2.6s;
}

.doomed-fire-burst {
  position: absolute;
  width: 8px;
  height: 8px;
  background: radial-gradient(circle, #f59e0b, #dc2626);
  border-radius: 50%;
  animation: doomed-fire-explosion 3s ease-in-out infinite;
}

.doomed-fire-burst-1 {
  top: 35%;
  left: 29%;
  animation-delay: 0.5s;
}

.doomed-fire-burst-2 {
  top: 25%;
  right: 24%;
  animation-delay: 1.8s;
}

.doomed-fire-burst-3 {
  top: 55%;
  left: 59%;
  animation-delay: 3.1s;
}

.doomed-smoke {
  position: absolute;
  width: 10px;
  height: 10px;
  background: radial-gradient(circle, rgba(75, 85, 99, 0.6), transparent);
  border-radius: 50%;
  animation: doomed-smoke-rise 5s linear infinite;
}

.doomed-smoke-1 {
  bottom: 20%;
  left: 25%;
  animation-delay: 0s;
}

.doomed-smoke-2 {
  bottom: 15%;
  right: 30%;
  animation-delay: 2.5s;
}

.doomed-destruction-pulse {
  position: absolute;
  inset: 6px;
  background: radial-gradient(ellipse at center, rgba(220, 38, 38, 0.1) 0%, transparent 70%);
  border-radius: 0.75rem;
  animation: doomed-destruction-throb 4s ease-in-out infinite;
}

@keyframes doomed-crack-spread {
  0%, 70%, 100% {
    opacity: 0;
    transform: scaleY(0);
  }
  10%, 60% {
    opacity: 0.8;
    transform: scaleY(1);
    box-shadow: 0 0 6px rgba(220, 38, 38, 0.6);
  }
  35% {
    opacity: 1;
    transform: scaleY(1.1);
    box-shadow: 0 0 12px rgba(220, 38, 38, 0.8);
  }
}

@keyframes doomed-fire-explosion {
  0%, 80%, 100% {
    transform: scale(0);
    opacity: 0;
  }
  10% {
    transform: scale(1);
    opacity: 1;
    box-shadow: 0 0 15px rgba(245, 158, 11, 0.8);
  }
  50% {
    transform: scale(1.5);
    opacity: 0.8;
    box-shadow: 0 0 20px rgba(220, 38, 38, 0.6);
  }
}

@keyframes doomed-smoke-rise {
  0% {
    transform: translateY(0) scale(0.5);
    opacity: 0.6;
  }
  50% {
    transform: translateY(-30px) scale(1);
    opacity: 0.4;
  }
  100% {
    transform: translateY(-60px) scale(1.5);
    opacity: 0;
  }
}

@keyframes doomed-destruction-throb {
  0%, 100% {
    background: radial-gradient(ellipse at center, rgba(220, 38, 38, 0.05) 0%, transparent 70%);
  }
  50% {
    background: radial-gradient(ellipse at center, rgba(220, 38, 38, 0.15) 0%, transparent 70%);
  }
}

/* --- CURSED - Orbes y Runas Sutiles --- */
.cursed-orbs-runes {
  border-radius: 0.75rem;
}

.cursed-orb {
  position: absolute;
  width: 8px;
  height: 8px;
  background: radial-gradient(circle, rgba(185, 28, 28, 0.8), rgba(127, 29, 29, 0.4));
  border-radius: 50%;
  animation: cursed-float 4s ease-in-out infinite;
  box-shadow: 0 0 8px rgba(185, 28, 28, 0.6);
}

.cursed-orb-1 {
  top: 20%;
  left: 15%;
  animation-delay: 0s;
}

.cursed-orb-2 {
  top: 60%;
  right: 20%;
  animation-delay: 1.3s;
}

.cursed-orb-3 {
  top: 40%;
  left: 70%;
  animation-delay: 2.6s;
}

.cursed-rune {
  position: absolute;
  font-size: 12px;
  color: rgba(185, 28, 28, 0.7);
  animation: cursed-rune-appear 6s ease-in-out infinite;
  text-shadow: 0 0 5px rgba(185, 28, 28, 0.8);
  user-select: none;
  pointer-events: none;
}

.cursed-rune-1 {
  top: 10%;
  right: 15%;
  animation-delay: 0s;
}

.cursed-rune-2 {
  bottom: 15%;
  left: 10%;
  animation-delay: 2s;
}

.cursed-rune-3 {
  top: 50%;
  right: 10%;
  animation-delay: 4s;
}

.cursed-shadow-pulse {
  position: absolute;
  inset: 5px;
  background: radial-gradient(ellipse at center, rgba(185, 28, 28, 0.1) 0%, transparent 60%);
  border-radius: 0.75rem;
  animation: cursed-shadow-throb 3s ease-in-out infinite;
}

.cursed-particle {
  position: absolute;
  width: 3px;
  height: 3px;
  background: #b91c1c;
  border-radius: 50%;
  animation: cursed-particle-drift 5s linear infinite;
}

.cursed-particle-1 {
  top: 30%;
  left: 25%;
  animation-delay: 0s;
}

.cursed-particle-2 {
  top: 70%;
  right: 30%;
  animation-delay: 1.7s;
}

.cursed-particle-3 {
  top: 50%;
  left: 60%;
  animation-delay: 3.4s;
}

@keyframes cursed-float {
  0%, 100% {
    transform: translateY(0) translateX(0) scale(0.8);
    opacity: 0.4;
  }
  25% {
    transform: translateY(-8px) translateX(3px) scale(1);
    opacity: 0.8;
  }
  50% {
    transform: translateY(-4px) translateX(-2px) scale(1.1);
    opacity: 1;
  }
  75% {
    transform: translateY(-12px) translateX(4px) scale(0.9);
    opacity: 0.6;
  }
}

@keyframes cursed-rune-appear {
  0%, 80%, 100% {
    opacity: 0;
    transform: scale(0.5) rotate(0deg);
  }
  10%, 70% {
    opacity: 0.8;
    transform: scale(1) rotate(5deg);
  }
  40% {
    opacity: 1;
    transform: scale(1.2) rotate(-3deg);
  }
}

@keyframes cursed-shadow-throb {
  0%, 100% {
    background: radial-gradient(ellipse at center, rgba(185, 28, 28, 0.05) 0%, transparent 60%);
  }
  50% {
    background: radial-gradient(ellipse at center, rgba(185, 28, 28, 0.15) 0%, transparent 60%);
  }
}

@keyframes cursed-particle-drift {
  0% {
    transform: translateY(0) translateX(0) rotate(0deg);
    opacity: 0;
  }
  10% {
    opacity: 0.6;
  }
  50% {
    transform: translateY(-20px) translateX(10px) rotate(180deg);
    opacity: 1;
  }
  90% {
    opacity: 0.4;
  }
  100% {
    transform: translateY(-40px) translateX(-5px) rotate(360deg);
    opacity: 0;
  }
}

/* --- BROKEN (era Doomed) - Humo --- */
.worn-smoke::before {
  content: '';
  position: absolute;
  inset: -20px;
  background: radial-gradient(ellipse at 30% 70%, rgba(105,105,105,0.3) 0%, transparent 70%);
  animation: smoke-drift 4s ease-in-out infinite;
}
@keyframes smoke-drift { 0% { transform: translateY(0px) rotate(0deg); opacity: 0.6; } 50% { transform: translateY(-10px) rotate(180deg); opacity: 0.8; } 100% { transform: translateY(0px) rotate(360deg); opacity: 0.6; } }

/* --- WORN - Polvo y Rayones --- */
.broken-dust-scratches::before {
  content: '';
  position: absolute;
  inset: 0;
  background: repeating-linear-gradient( 45deg, transparent, transparent 10px, rgba(100,100,100,0.4) 10px, rgba(100,100,100,0.4) 11px );
  opacity: 0.5;
}

/* --- MUNDANE - Brillo y Pulso --- */
.mundane-glow-pulse::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 50% 50%, rgba(50,205,50,0.2) 0%, transparent 70%);
  animation: gentle-glow 3s ease-in-out infinite;
}
@keyframes gentle-glow { 0%, 100% { opacity: 0.5; } 50% { opacity: 0.8; } }

/* --- NUEVO: UNCOMMON - Brillo que Respira --- */
.uncommon-breathing-glow {
  animation: breathing-light 3s ease-in-out infinite;
}

@keyframes breathing-light {
  0%, 100% {
    filter: opacity(0);
  }
  50% {
    filter: opacity(0.4); /* o 1.05 si querés más sutil */
  }
}

/* --- RARE - Brillo Simple --- */
.rare-shine::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
  animation: simple-shine 4s ease-in-out infinite;
}
@keyframes simple-shine { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }

/* --- ULTRA RARE - Plasma y Holograma --- */
.ultra-rare-plasma-hologram::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: 
    repeating-linear-gradient(
      45deg,
      transparent,
      transparent 8px,
      rgba(147,51,234,0.3) 8px,
      rgba(147,51,234,0.3) 12px,
      transparent 12px,
      transparent 16px
    );
  animation: hologram-flicker 1.5s ease-in-out infinite;
}

@keyframes hologram-flicker {
  0%, 100% { opacity: 0.8; }
  50% { opacity: 0.3; }
}

/* =================== ANIMACIONES EPIC =================== */
.epic-power-flow {
}

.epic-wave {
  position: absolute;
  border: 2px solid rgba(251, 191, 36, 0.6);
  animation: epic-pulse 2s ease-in-out infinite;
}

.epic-wave-1 {
  inset: 0;
  animation-delay: 0s;
}

.epic-wave-2 {
  inset: 4px;
  animation-delay: 0.3s;
}

.epic-wave-3 {
  inset: 8px;
  animation-delay: 0.6s;
}

@keyframes epic-pulse {
  0%, 100% {
    border-color: rgba(251, 191, 36, 0.1);
    box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.4);
  }
  50% {
    border-color: rgba(251, 191, 36, 0.3);
    box-shadow: 0 0 20px 5px rgba(251, 191, 36, 0.2);
  }
}

/* =================== ANIMACIONES LEGENDARY MEJORADAS =================== */
.legendary-ray {
  position: absolute;
  width: 2px;
  height: 60%;
  background: linear-gradient(to top, transparent, #80c8ff, #57abff, transparent);
  /* background: linear-gradient(to top, transparent, #fbbf24, #f59e0b, transparent); */
  transform-origin: bottom center;
  animation: legendary-ray-rotate 4s linear infinite;
  opacity: 0.1;
}

.legendary-ray-1 {
  bottom: 50%;
  left: 50%;
  transform: translateX(-50%) rotate(0deg);
  animation-delay: 0s;
}

.legendary-ray-2 {
  bottom: 50%;
  left: 50%;
  transform: translateX(-50%) rotate(60deg);
  animation-delay: 0.7s;
}

.legendary-ray-3 {
  bottom: 50%;
  left: 50%;
  transform: translateX(-50%) rotate(120deg);
  animation-delay: 1.4s;
}

.legendary-ray-4 {
  bottom: 50%;
  left: 50%;
  transform: translateX(-50%) rotate(180deg);
  animation-delay: 2.1s;
}

.legendary-ray-5 {
  bottom: 50%;
  left: 50%;
  transform: translateX(-50%) rotate(240deg);
  animation-delay: 2.8s;
}

.legendary-ray-6 {
  bottom: 50%;
  left: 50%;
  transform: translateX(-50%) rotate(300deg);
  animation-delay: 3.5s;
}

.legendary-sparkle {
  position: absolute;
  width: 4px;
  height: 4px;
  background: radial-gradient(circle, #fbbf24, #f59e0b);
  border-radius: 50%;
  animation: legendary-sparkle-twinkle 2s ease-in-out infinite;
}

.legendary-sparkle-1 {
  top: 15%;
  left: 25%;
  animation-delay: 0s;
}

.legendary-sparkle-2 {
  top: 30%;
  right: 20%;
  animation-delay: 0.4s;
}

.legendary-sparkle-3 {
  top: 60%;
  left: 15%;
  animation-delay: 0.8s;
}

.legendary-sparkle-4 {
  top: 75%;
  right: 30%;
  animation-delay: 1.2s;
}

.legendary-sparkle-5 {
  top: 45%;
  left: 70%;
  animation-delay: 1.6s;
}

@keyframes legendary-ray-rotate {
  0% {
    transform: translateX(-50%) rotate(var(--start-rotation, 0deg)) scaleY(0.5);
    opacity: 0.1;
  }
  50% {
    transform: translateX(-50%) rotate(calc(var(--start-rotation, 0deg) + 180deg)) scaleY(1);
    opacity: 0.4;
    box-shadow: 0 0 15px rgba(36, 151, 251, 0.6);
  }
  100% {
    transform: translateX(-50%) rotate(calc(var(--start-rotation, 0deg) + 360deg)) scaleY(0.5);
    opacity: 0.1;
  }
}

@keyframes legendary-sparkle-twinkle {
  0%, 100% {
    transform: scale(0.3);
    opacity: 0.4;
  }
  50% {
    transform: scale(1.2);
    opacity: 1;
    box-shadow: 0 0 12px rgba(251, 191, 36, 0.8);
  }
}

/* =================== ANIMACIONES ULTRA =================== */
.ultra-cosmic-field {
}

.ultra-star {
  position: absolute;
  width: 2px;
  height: 2px;
  background: #ffffffbf;
  border-radius: 50%;
  animation: ultra-twinkle 2s ease-in-out infinite;
}

.ultra-star-1 {
  top: 15%;
  left: 20%;
  animation-delay: 0s;
}

.ultra-star-2 {
  top: 25%;
  right: 30%;
  animation-delay: 0.3s;
}

.ultra-star-3 {
  top: 45%;
  left: 15%;
  animation-delay: 0.6s;
}

.ultra-star-4 {
  top: 65%;
  right: 20%;
  animation-delay: 0.9s;
}

.ultra-star-5 {
  top: 75%;
  left: 40%;
  animation-delay: 1.2s;
}

.ultra-star-6 {
  top: 35%;
  left: 60%;
  animation-delay: 1.5s;
}

.ultra-nebula {
  position: absolute;
  inset: 1px;
  pointer-events: none;
  /* definimos solo una vez el fondo */
  background: radial-gradient(
    ellipse at center,
    rgba(6, 182, 212, 0.7) 0%,
    transparent 70%
  );
  /* y animamos la opacidad */
  animation: ultra-nebula-pulse 2s ease-in-out infinite;
}

@keyframes ultra-twinkle {
  0%, 100% {
    opacity: 0.3;
    transform: scale(0.5);
  }
  50% {
    opacity: 1;
    transform: scale(2);
    box-shadow: 0 0 10px #06b6d4;
  }
}

@keyframes ultra-nebula-pulse {
  0%, 100% {
    opacity: 0.1;   /* muy tenue */
    scale: 1.5;
  }
  50% {
    opacity: 0.7;   /* más visible, pero suave */
    scale: 1;
  }
}
/* =================== HOVER EFFECTS =================== */
.achievement-card:hover .ravaged-flame {
  animation-duration: 1.5s;
}

.achievement-card:hover .ravaged-ember {
  animation-duration: 3s;
}

.achievement-card:hover .ravaged-heat-wave {
  animation-duration: 2s;
}

.achievement-card:hover .ravaged-core-fire {
  animation-duration: 1.8s;
}

.achievement-card:hover .doomed-crack {
  animation-duration: 3s;
}

.achievement-card:hover .doomed-fire-burst {
  animation-duration: 2s;
}

.achievement-card:hover .doomed-smoke {
  animation-duration: 3.5s;
}

.achievement-card:hover .doomed-destruction-pulse {
  animation-duration: 2.5s;
}

.achievement-card:hover .cursed-orb {
  animation-duration: 2s;
}

.achievement-card:hover .cursed-rune {
  animation-duration: 3s;
}

.achievement-card:hover .cursed-shadow-pulse {
  animation-duration: 1.5s;
}

.achievement-card:hover .cursed-particle {
  animation-duration: 3s;
}

.achievement-card:hover .epic-wave {
  animation-duration: 1s;
}

/* Hover effect para legendary */
.achievement-card:hover .legendary-ray {
  animation-duration: 2s;
}

.achievement-card:hover .legendary-aura {
  animation-duration: 1.5s;
}

.achievement-card:hover .legendary-sparkle {
  animation-duration: 1s;
}

.achievement-card:hover .legendary-crown {
  animation-duration: 1.2s;
}

.achievement-card:hover .ultra-star {
  animation-duration: 1.5s;
}

.achievement-card:hover .ultra-nebula {
  animation-duration: 2s;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const cards = document.querySelectorAll('.achievement-card');
  cards.forEach(card => {
    const flipCard = () => {
      card.classList.toggle('is-flipped');
    };
    card.addEventListener('click', flipCard);
    card.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        flipCard();
      }
    });
  });
});
</script>